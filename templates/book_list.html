{% extends 'base.html' %}

{% block title %}
    Book List
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">ðŸ“š Book List</h2>
    <table class="table table-striped table-bordered table-hover align-middle shadow">
        <thead class="table-dark">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Author</th>
                <th scope="col">Title</th>
                <th scope="col">Description</th>
                <th scope="col">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for books in book_list %}
            <tr>
                <th scope="row">{{ books.id }}</th>
                <td>{{ books.author.name }}</td>
                <td>{{ books.title }}</td>
                <td>{{ books.description|truncatechars:50 }}</td>
                <td class="text-nowrap">
                    {% if request.user.role == 'librarian' %}
                        <a href="{% url 'book_update' books.id %}" class="btn btn-sm btn-outline-warning">Update</a>
                        <!-- Button to trigger modal -->
                        <button type="button" class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal{{ books.id }}">
                            Delete
                        </button>

                        <!-- Delete Modal -->
                        <div class="modal fade" id="deleteModal{{ books.id }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ books.id }}" aria-hidden="true">
                          <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content shadow">
                              <div class="modal-header bg-danger text-white">
                                <h5 class="modal-title" id="deleteModalLabel{{ books.id }}">Diqqat!</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>
                              <div class="modal-body">
                                Siz rostdan ham ushbu kitobni oâ€˜chirmoqchimisiz?
                              </div>
                              <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Bekor qilish</button>
                                <a href="{% url 'book_delated' books.id %}" class="btn btn-danger">Ha, oâ€˜chirish</a>
                              </div>
                            </div>
                          </div>
                        </div>
                    {% endif %}
                    <a href="{% url 'book_detail' books.id %}" class="btn btn-sm btn-outline-primary">Details</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">No books found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
